# zerossl/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: cert-manager

resources:
- clusterissuer.yaml
- certificate.yaml

# Configure variable references
vars:
- name: CERT_MANAGER_EMAIL
  objref:
    kind: ConfigMap
    name: cert-manager-config
    namespace: cert-manager
  fieldref:
    fieldpath: data.email
- name: CERT_MANAGER_DOMAIN
  objref:
    kind: ConfigMap
    name: cert-manager-config
    namespace: cert-manager
  fieldref:
    fieldpath: data.domain
- name: ZEROSSL_KEY_ID
  objref:
    kind: Secret
    name: zerossl-api-secret
    namespace: cert-manager
  fieldref:
    fieldpath: data.zero_api-id


configMapGenerator:
- name: cert-manager-config
  envs:
  - ./config.env
  behavior: replace 