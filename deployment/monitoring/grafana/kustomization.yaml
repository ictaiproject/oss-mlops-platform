
namespace: monitoring

resources:
- grafana-deployment.yaml
- grafana-service.yaml
- grafana-datasource-config.yaml
- grafana-pvc.yaml
- dashboards-config-map.yaml
- dashboards-json-config-map.yaml
- grafana-ingress.yaml
- grafana-virtualservice.yaml


configMapGenerator:
  - name: grafana-configmap-domain
    envs:
      - config.env
    



replacements:
  - source:
      kind: ConfigMap
      name: grafana-configmap-domain
      fieldPath: data.DOMAIN
    targets:
      - select:
          kind: Ingress
          name: grafana-ingress
        fieldPaths:
          - spec.rules.0.host
      - select:
          kind: VirtualService
          name: grafana-virtualservice
        fieldPaths:
          - spec.hosts.0
      - select:
          kind: Service
          name: grafana-ingress
        fieldPaths:
          - spec.tls.0.hosts.0